ProxyRequests Off
ProxyPreserveHost On
<VirtualHost *:80>
  ServerName <%= node['sonar']['web_domain'] %>
  ServerAlias <%= node['sonar']['web_domain'] %>
  ServerAdmin admin@<%= node['sonar']['web_domain'] %>
  ProxyPass / http://<%= node['sonar']['web_host'] %>:<%= node['sonar']['web_port'] %>/
  ProxyPassReverse / http://<%= node['sonar']['web_host'] %>:<%= node['sonar']['web_port'] %>/
  
  LogLevel info
  ErrorLog <%= node['apache']['log_dir'] %>/<%= node['sonar']['web_domain'] %>-error.log
  CustomLog <%= node['apache']['log_dir'] %>/<%= node['sonar']['web_domain'] %>-access.log combined
</VirtualHost>